import{r as h,ak as N,d as w,a5 as y,o as I,j as D,g as B,u,bz as E,aq as F,c as T,w as _,bJ as U,a as i,h as S,t as V,_ as L}from"./index.715954a5.js";import{f as R,g as j,_ as q,a as G}from"./rule.6029947b.js";import{u as J}from"./useSmsCode.805f7333.js";import{_ as H}from"./Input.a6970fac.js";import{_ as K}from"./Space.2071681e.js";import"./useLoading.49c5971f.js";import"./get-slot.ef4c002f.js";function O(s=152,o=40){const t=h(),a=h("");function c(n){a.value=n}function e(){!t.value||(a.value=Q(t.value,s,o))}return N(()=>{e()}),{domRef:t,imgCode:a,setImgCode:c,getImgCode:e}}function d(s,o){return Math.floor(Math.random()*(o-s)+s)}function v(s,o){const t=d(s,o),a=d(s,o),c=d(s,o);return`rgb(${t},${a},${c})`}function Q(s,o,t){let a="";const c="0123456789",e=s.getContext("2d");if(!e)return a;e.fillStyle=v(180,230),e.fillRect(0,0,o,t);for(let n=0;n<4;n+=1){const m=c[d(0,c.length)];a+=m;const l=d(18,41),p=d(-30,30);e.font=`${l}px Simhei`,e.textBaseline="top",e.fillStyle=v(80,150),e.save(),e.translate(30*n+23,15),e.rotate(p*Math.PI/180),e.fillText(m,-15+5,-15),e.restore()}for(let n=0;n<5;n+=1)e.beginPath(),e.moveTo(d(0,o),d(0,t)),e.lineTo(d(0,o),d(0,t)),e.strokeStyle=v(180,230),e.closePath(),e.stroke();for(let n=0;n<41;n+=1)e.beginPath(),e.arc(d(0,o),d(0,t),1,0,2*Math.PI),e.closePath(),e.fillStyle=v(150,200),e.fill();return a}const W=w({props:{code:{default:""}},emits:["update:code"],setup(s,{expose:o,emit:t}){const a=s,{domRef:c,imgCode:e,setImgCode:n,getImgCode:m}=O();return y(()=>a.code,l=>{n(l)}),y(e,l=>{t("update:code",l)}),o({getImgCode:m}),(l,p)=>(I(),D("div",null,[B("canvas",{ref_key:"domRef",ref:c,width:"152",height:"40",class:"cursor-pointer",onClick:p[0]||(p[0]=(...b)=>u(m)&&u(m)(...b))},null,512)]))}}),X={class:"flex-y-center w-full"},Y=B("div",{class:"w-18px"},null,-1),Z={class:"pl-8px"},ee=S(" \u786E\u5B9A "),oe=S("\u8FD4\u56DE"),de=w({setup(s){const o=E(),{toLoginModule:t}=U(),{label:a,isCounting:c,loading:e,getSmsCode:n}=J(),m=h(null),l=F({phone:"",code:"",imgCode:""}),p=h(""),b={phone:R.phone,code:R.code,imgCode:j(p)};function $(){n(l.phone)}function A(x){!m.value||(x.preventDefault(),m.value.validate(r=>{var g,C;r?(C=window.$message)==null||C.error("\u9A8C\u8BC1\u5931\u8D25"):(g=window.$message)==null||g.success("\u9A8C\u8BC1\u901A\u8FC7!")}))}return(x,r)=>{const g=H,C=G,k=L,z=W,M=K,P=q;return I(),T(P,{ref_key:"formRef",ref:m,model:u(l),rules:b,size:"large","show-label":!1},{default:_(()=>[i(C,{path:"phone"},{default:_(()=>[i(g,{value:u(l).phone,"onUpdate:value":r[0]||(r[0]=f=>u(l).phone=f),placeholder:"\u624B\u673A\u53F7\u7801"},null,8,["value"])]),_:1}),i(C,{path:"code"},{default:_(()=>[B("div",X,[i(g,{value:u(l).code,"onUpdate:value":r[1]||(r[1]=f=>u(l).code=f),placeholder:"\u9A8C\u8BC1\u7801"},null,8,["value"]),Y,i(k,{size:"large",disabled:u(c),loading:u(e),onClick:$},{default:_(()=>[S(V(u(a)),1)]),_:1},8,["disabled","loading"])])]),_:1}),i(C,{path:"imgCode"},{default:_(()=>[i(g,{value:u(l).imgCode,"onUpdate:value":r[2]||(r[2]=f=>u(l).imgCode=f),placeholder:"\u9A8C\u8BC1\u7801,\u70B9\u51FB\u56FE\u7247\u5237\u65B0"},null,8,["value"]),B("div",Z,[i(z,{code:p.value,"onUpdate:code":r[3]||(r[3]=f=>p.value=f)},null,8,["code"])])]),_:1}),i(M,{vertical:!0,size:18},{default:_(()=>[i(k,{type:"primary",size:"large",block:!0,round:!0,loading:u(o).loginLoading,onClick:A},{default:_(()=>[ee]),_:1},8,["loading"]),i(k,{size:"large",block:!0,round:!0,onClick:r[4]||(r[4]=f=>u(t)("pwd-login"))},{default:_(()=>[oe]),_:1})]),_:1})]),_:1},8,["model"])}}});export{de as default};
