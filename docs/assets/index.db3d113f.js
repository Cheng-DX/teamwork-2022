import{r as h,M as N,d as w,G as y,o as I,g as D,l as b,e as s,bG as E,j as F,b as T,w as _,k as U,c as d,f as S,m as V,_ as G}from"./index.a36190ed.js";import{f as R,b as L,_ as j,a as q}from"./rule.b5bb2c87.js";import{u as H}from"./useSmsCode.2011412e.js";import{_ as J}from"./Input.d2404834.js";import{_ as K}from"./Space.1d40ed16.js";import"./useBoolean.3e9c7eae.js";import"./use-locale.40cf2c9b.js";import"./get-slot.ef4c002f.js";function O(u=152,o=40){const t=h(),a=h("");function c(n){a.value=n}function e(){!t.value||(a.value=Q(t.value,u,o))}return N(()=>{e()}),{domRef:t,imgCode:a,setImgCode:c,getImgCode:e}}function i(u,o){return Math.floor(Math.random()*(o-u)+u)}function v(u,o){const t=i(u,o),a=i(u,o),c=i(u,o);return`rgb(${t},${a},${c})`}function Q(u,o,t){let a="";const c="0123456789",e=u.getContext("2d");if(!e)return a;e.fillStyle=v(180,230),e.fillRect(0,0,o,t);for(let n=0;n<4;n+=1){const m=c[i(0,c.length)];a+=m;const l=i(18,41),p=i(-30,30);e.font=`${l}px Simhei`,e.textBaseline="top",e.fillStyle=v(80,150),e.save(),e.translate(30*n+23,15),e.rotate(p*Math.PI/180),e.fillText(m,-15+5,-15),e.restore()}for(let n=0;n<5;n+=1)e.beginPath(),e.moveTo(i(0,o),i(0,t)),e.lineTo(i(0,o),i(0,t)),e.strokeStyle=v(180,230),e.closePath(),e.stroke();for(let n=0;n<41;n+=1)e.beginPath(),e.arc(i(0,o),i(0,t),1,0,2*Math.PI),e.closePath(),e.fillStyle=v(150,200),e.fill();return a}const W=w({props:{code:{default:""}},emits:["update:code"],setup(u,{expose:o,emit:t}){const a=u,{domRef:c,imgCode:e,setImgCode:n,getImgCode:m}=O();return y(()=>a.code,l=>{n(l)}),y(e,l=>{t("update:code",l)}),o({getImgCode:m}),(l,p)=>(I(),D("div",null,[b("canvas",{ref_key:"domRef",ref:c,width:"152",height:"40",class:"cursor-pointer",onClick:p[0]||(p[0]=(...B)=>s(m)&&s(m)(...B))},null,512)]))}}),X={class:"flex-y-center w-full"},Y=b("div",{class:"w-18px"},null,-1),Z={class:"pl-8px"},ee=S(" \u786E\u5B9A "),oe=S("\u8FD4\u56DE"),de=w({setup(u){const o=E(),{toLoginModule:t}=U(),{label:a,isCounting:c,loading:e,getSmsCode:n}=H(),m=h(null),l=F({phone:"",code:"",imgCode:""}),p=h(""),B={phone:R.phone,code:R.code,imgCode:L(p)};function A(){n(l.phone)}function M(x){!m.value||(x.preventDefault(),m.value.validate(r=>{var g,C;r?(C=window.$message)==null||C.error("\u9A8C\u8BC1\u5931\u8D25"):(g=window.$message)==null||g.success("\u9A8C\u8BC1\u901A\u8FC7!")}))}return(x,r)=>{const g=J,C=q,k=G,$=W,P=K,z=j;return I(),T(z,{ref_key:"formRef",ref:m,model:s(l),rules:B,size:"large","show-label":!1},{default:_(()=>[d(C,{path:"phone"},{default:_(()=>[d(g,{value:s(l).phone,"onUpdate:value":r[0]||(r[0]=f=>s(l).phone=f),placeholder:"\u624B\u673A\u53F7\u7801"},null,8,["value"])]),_:1}),d(C,{path:"code"},{default:_(()=>[b("div",X,[d(g,{value:s(l).code,"onUpdate:value":r[1]||(r[1]=f=>s(l).code=f),placeholder:"\u9A8C\u8BC1\u7801"},null,8,["value"]),Y,d(k,{size:"large",disabled:s(c),loading:s(e),onClick:A},{default:_(()=>[S(V(s(a)),1)]),_:1},8,["disabled","loading"])])]),_:1}),d(C,{path:"imgCode"},{default:_(()=>[d(g,{value:s(l).imgCode,"onUpdate:value":r[2]||(r[2]=f=>s(l).imgCode=f),placeholder:"\u9A8C\u8BC1\u7801,\u70B9\u51FB\u56FE\u7247\u5237\u65B0"},null,8,["value"]),b("div",Z,[d($,{code:p.value,"onUpdate:code":r[3]||(r[3]=f=>p.value=f)},null,8,["code"])])]),_:1}),d(P,{vertical:!0,size:18},{default:_(()=>[d(k,{type:"primary",size:"large",block:!0,round:!0,loading:s(o).loginLoading,onClick:M},{default:_(()=>[ee]),_:1},8,["loading"]),d(k,{size:"large",block:!0,round:!0,onClick:r[4]||(r[4]=f=>s(t)("pwd-login"))},{default:_(()=>[oe]),_:1})]),_:1})]),_:1},8,["model"])}}});export{de as default};
